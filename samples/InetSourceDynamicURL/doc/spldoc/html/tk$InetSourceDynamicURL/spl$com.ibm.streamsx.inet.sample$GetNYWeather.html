<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en-us" lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2005"/>
<meta name="DC.rights.owner" content="(C) Copyright 2005"/>
<meta name="DC.Type" content="reference"/>
<meta name="DC.Title" content="SPL File GetNYWeather.spl"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="spldoc_compilationunit"/>
<link rel="stylesheet" type="text/css" href="../../html/commonltr.css"/>
<link rel="stylesheet" type="text/css" href="../../html/spldoc.css"/>
<title>SPL File GetNYWeather.spl</title>
</head>
<body id="spldoc_compilationunit">


<h1 class="title topictitle1">SPL File <tt class="ph tt">GetNYWeather.spl</tt></h1>

<div class="body refbody">
<div class="section">
<p class="p">
<a class="xref" href="../toolkits/toolkits.html">Toolkits</a> &gt; <a class="xref" href="tk$InetSourceDynamicURL.html">InetSourceDynamicURL 1.0.0</a> &gt; <a class="xref" href="ns$com.ibm.streamsx.inet.sample.html">com.ibm.streamsx.inet.sample</a> &gt; GetNYWeather.spl</p>

</div>

<div class="section"><h2 class="title sectiontitle splhead-1">Content</h2>
  
    <dl class="dl">
    <dt class="dt dlterm"/>
<dd class="dd"/>

    
      <dt class="dt dlterm splhead-2">Composite Operators</dt>

      <dd class="dd"><ul class="sl simple">
<li class="sli"><strong class="ph b"><a class="xref" href="#spldoc_compilationunit__composite_operator__GetWeatherDynamic">composite GetWeatherDynamic</a></strong>: Demonstrates the use of re-evaluated URLS with the Inetsource operator.
</li>

     </ul>
</dd>

    
    
      <dt class="dt dlterm splhead-2">Functions</dt>

      <dd class="dd"><ul class="sl simple">
<li class="sli"><strong class="ph b"><a class="xref" href="#spldoc_compilationunit__function__getLocation">rstring getLocation()</a></strong>: This function helps us create URLs that are different every fetch.
</li>

     </ul>
</dd>

    
     </dl>

</div>

<div class="section"><h2 class="title sectiontitle splhead-1">Composite Operators</h2>
  
</div>

<div class="section" id="spldoc_compilationunit__composite_operator__GetWeatherDynamic"><h2 class="title sectiontitle splpart">composite GetWeatherDynamic</h2>
  
</div>

<div class="section">

<p class="p">Demonstrates the use of re-evaluated URLS with the Inetsource operator. The URL list in this case is a single URL, but it contains a call to  getLocation().  getLocation is a a stateful function, so depending on when  it is called, it gives different results.
</p>

<p class="p">The URL is evaluated before every fetch. If the URL has changed, information about the last modification time is discarded.  
</p>

<p class="p">If you run this application, you'll see lines like &lt;code&gt; result: 000 SAUS70 KWBC 271900 RRX MTRJFK METAR KJFK 271951Z 19007KT 10SM FEW038 SCT060 SCT100 BKN160 BKN250 26/17 A2980 RMK AO2 RAB1853E36 SLP092 P0000 T02560167 &lt;/code&gt; alternating with  &lt;code&gt;result: 000 SAUS80 KWBC 272000 MTRNYC METAR KNYC 271951Z AUTO 25008G15KT 10SM SCT120 28/15 A2982 RMK AO2 SLP087 T02830150&lt;/code&gt; (notice the KJFK, and KNYC 8th field).
</p>

<p class="p">In particular, the order of events: First URL, with KJFK is fetched, and result line is printed. Second URL, with KJFK is computed, but the URL has not changed, so we check last modified time before sending results.  Last modified time is prior to the last fetch, so no results are printed. Third URL, with KYNC is computed.  The URL has now changed, so last modified time is irrelevant, and a result is printed. Fourth URL, wiht KJFK is computed.  The URL has now changed, so last modified time is irrelevant, and a result is printed. Fifth URL, with KJFK is computed, but the URL has not changed... 
</p>

</div>

<div class="section">
</div>

<div class="section">
</div>

<div class="section">
</div>

<div class="section"><h2 class="title sectiontitle splhead-2">Composite Operator Graph</h2>
  
</div>

<div class="section splgraph">
<object type="image/svg+xml" data="../../image/tk$InetSourceDynamicURL/op$com.ibm.streamsx.inet.sample$GetWeatherDynamic.svg" width="232" height="109">
<span>SPL composite operator image not displayed. Problem loading file: ../../image/tk$InetSourceDynamicURL/op$com.ibm.streamsx.inet.sample$GetWeatherDynamic.svg
</span>
</object>
</div>

<div class="section"><h2 class="title sectiontitle splhead-1">Functions</h2>
  
</div>

<div class="section" id="spldoc_compilationunit__function__getLocation"><h2 class="title sectiontitle splpart">rstring getLocation()</h2>
  
</div>
<div class="section">

<p class="p">This function helps us create URLs that are different every fetch.   As used in the application, it usually returns two KJFKs and then one KNYCs.  The 10 in the function below is related to the  10 in the fetchInterval in the GetWeatherDynamic composite. 
</p>

</div>

<div class="section">
</div>

<div class="section"><h2 class="title sectiontitle">Returns</h2>

<ul class="sl simple"><li class="sli">
<tt class="ph tt">rstring</tt>
</li>
</ul>

</div>

</div>


</body>
</html>